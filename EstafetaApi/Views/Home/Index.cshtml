@{ ViewBag.Title = "Home Page"; }


<div class="container">
    <div class="row">
        <div class="col-xs-12">
            <legend>Estafeta Api Test</legend>
            <h2>
                Tracking
            </h2>

            <h3>End Point:</h3>

            <pre><code>/Api/Rastreo/?codigo=[trackCode]&tipo=[type]</code></pre>




            <div class="form-group">
                <label class="control-label">
                    Code type
                </label>

                <select id="option" class="form-control" required="required">
                    <option value="1">22 Digits (For now)</option>
                </select>
                <label class="control-label">
                    Code
                </label>
                <input type="text" id="code" class="form-control">

            </div>
            <button type="button" id="btn" class="btn btn-primary">Send</button>

            <p id="loading" class="hidden">
                Loading the awesome data.....
            </p>
            
        </div>
    </div>

</div>
<div class="container">
    <div class="row">
        <style>
            .responseData {
                background-color: #f5f5f5;
            }
        </style>
        
        <h2>Main Info</h2>

        <div class="col-xs-12 responseData" id="response"></div>
        <h2>History</h2>
        <div class="col-xs-12 responseData" id="history">
            
        </div>
    </div>
</div>

@section Scripts{
    <script>
        (function () {
            
            var $btn = $("#btn");
            $btn.click(function () {
                var code = $("#code").val();
                var option = $("#option").val();
                $("#loading").show();
                var url = "/Api/Rastreo/?codigo=" + code + "&tipo=" + option;
                $.getJSON(url, function (response) {
                    $("#loading").hide();
                    $("#response").text("");
                    console.log(response);
                    for (var i = 0; i < response.KeyValues.length; i++) {
                        var element = response.KeyValues[i];
                        if (element) {
                            $("#response").append("<p>Key: " + element.Key + " --- Value: " + element.Value + "</p>");
                        }
                    }

                    for (var j = 0; j < response.Histories.length; j++) {
                        var jelement = response.Histories[j];
                        if (jelement) {
                            $("#history").append("<p>/// <strong> Date: </strong>" + jelement.Date + " |||| Place:" + jelement.Place + " ||| Comments:" + jelement.Comments + "</p>");
                        }
                    }
                });
            });
        })();

    </script>
}